"use strict";!function(){var s,l,r,d,c,i,o,u,p;"undefined"!=typeof wp&&(s=wp.i18n.__,null!==(l=document.querySelector("#social-planner-metabox > .inside"))&&void 0!==window.socialPlannerMetabox&&(r=window.socialPlannerMetabox,d=function(e,t){var a=function(){var e=Date.now();r.offset&&(r.offset=parseInt(r.offset),isNaN(r.offset)||(a=(new Date).getTimezoneOffset(),e=new Date(e+60*a*1e3+1e3*r.offset)));var t={},a=new Date(e),e=a.getHours();t.hour=("0"+e).slice(-2);a=a.getMinutes();return t.minute=("0"+a).slice(-2),t}(),n=document.createElement("input");n.setAttribute("type","text"),n.setAttribute("name",t.name+"[hour]"),n.value=a.hour,e.appendChild(n),n.addEventListener("change",function(){return n.value.match(/^\d+$/)?(n.value=("0"+parseInt(n.value)).slice(-2),23<n.value||n.value<0?n.value=a.hour:void(a.hour=n.value)):n.value=a.hour});var i=document.createElement("span");i.textContent=":",e.appendChild(i);var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("name",t.name+"[minute]"),l.value=a.minute,e.appendChild(l),l.addEventListener("change",function(){return l.value.match(/^\d+$/)?(l.value=("0"+l.value).slice(-2),59<l.value||l.value<0?l.value=a.minute:void(a.minute=l.value)):l.value=a.minute})},c=function(e,t,a){var n=document.createElement("option");return n.textContent=t,n.value=a||"",e.appendChild(n),n},i=function(e,t){var a=document.createElement("div");a.classList.add("social-planner-snippet"),e.appendChild(a);e=document.createElement("textarea");e.classList.add("social-planner-excerpt"),e.setAttribute("placeholder",s("Social networks summary","social-planner")),e.setAttribute("name",t.name+"[excerpt]"),t.data.excerpt&&(e.textContent=t.data.excerpt),a.appendChild(e),function(e,t){if(wp.media){var n=document.createElement("figure");n.classList.add("social-planner-poster"),e.appendChild(n);var i=document.createElement("button");i.classList.add("choose"),i.setAttribute("type","button"),i.textContent="+",n.appendChild(i);var l=document.createElement("img"),d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name",t.name+"[attachment]"),t.data.attachment&&(d.value=t.data.attachment),n.appendChild(d);var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",t.name+"[thumbnail]"),t.data.thumbnail&&(r.value=t.data.thumbnail,l.setAttribute("src",t.data.thumbnail),n.insertBefore(l,i)),n.appendChild(r),i.addEventListener("click",function(){var a=wp.media({title:s("Choose poster image","social-planner"),multiple:!1});a.on("select",function(){var e=a.state().get("selection").first().toJSON(),t=e.url;d.value=e.id,void 0!==e.sizes.thumbnail&&(t=e.sizes.thumbnail.url),r.value=t,l.setAttribute("src",t),l.parentNode||n.insertBefore(l,i)}),a.open()});t=document.createElement("button");t.classList.add("remove"),t.setAttribute("type","button"),n.appendChild(t),t.addEventListener("click",function(e){e.stopPropagation(),d.value="",r.value="",n.removeChild(l)})}}(a,t)},o=function(e,t){var a=document.createElement("div");a.classList.add("social-planner-targets"),e.appendChild(a),r.errors||r.sent||function(e,t){for(var a in r.providers){var n,i,l,d=r.providers[a];d.label&&((n=document.createElement("label")).classList.add("social-planner-check"),e.append(n),(l=document.createElement("input")).setAttribute("type","checkbox"),l.setAttribute("name",t.name+"[targets][]"),l.value=a,(i=t.data.targets||[])&&-1<i.indexOf(a)&&l.setAttribute("checked","checked"),n.appendChild(l),(l=document.createElement("span")).textContent=d.label,n.appendChild(l))}}(a,t)},u=function(e){var t=(new Date).getTime().toString(16);p(e,{name:r.meta+"["+t+"]"})},p=function(e,t){var a=document.createElement("fieldset");a.classList.add("social-planner-task"),e.appendChild(a),t.data=t.data||{},o(a,t);var n=document.createElement("button");n.classList.add("social-planner-remove"),n.setAttribute("type","button"),a.appendChild(n),n.addEventListener("click",function(){e.removeChild(a),e.hasChildNodes()||u(e)}),i(a,t),function(e,t){var a=document.createElement("label");a.classList.add("social-planner-preview"),e.appendChild(a);e=document.createElement("input");e.setAttribute("type","checkbox"),e.setAttribute("name",t.name+"[preview]"),e.value=1,t.data.preview&&e.setAttribute("checked","checked"),a.appendChild(e);e=document.createElement("span");e.textContent=s("Do not generate preview","social-planner"),a.appendChild(e)}(a,t),function(e,t){var a=document.createElement("div");a.classList.add("social-planner-scheduler"),e.appendChild(a);var n=document.createElement("select");n.setAttribute("name",t.name+"[date]"),a.appendChild(n);var i,l=document.createElement("div");for(i in l.classList.add("social-planner-time"),a.appendChild(l),c(n,s("Do not send automatically","social-planner")),c(n,s("Publish immediately","social-planner"),"now"),r.calendar=r.calendar||{},r.calendar)c(n,r.calendar[i],i);n.addEventListener("change",function(){for(;l.firstChild;)l.removeChild(l.lastChild);n.value&&"now"!==n.value&&d(l,t)})}(a,t)},function(){var e,t,a,n,i=document.createElement("div");if(i.classList.add("social-planner-list"),l.appendChild(i),!r.meta||!r.providers)return e=s("You need to configure providers on the plugin settings page.","social-planner"),(a=document.createElement("p")).classList.add("social-planner-warning"),a.textContent=e,l.appendChild(a);for(n in r.tasks=r.tasks||{},t=i,(a=document.createElement("button")).classList.add("social-planner-append","button"),a.setAttribute("type","button"),a.textContent=s("Add task","social-planner"),a.addEventListener("click",function(){u(t)}),l.appendChild(a),r.tasks)p(i,{data:r.tasks[n],name:r.meta+"["+n+"]"});i.hasChildNodes()||u(i)}()))}();